{% extends 'base.html' %}
{% block title %}
    {{ form.title }}
{% endblock %}
{% block content %}
    <main>
        <div class="container-xl">

            <!-- Back Link -->
            <div class="mb-4">
                {% if form.mode == "add" %}
                <a href="{{ url_for('chamber_applications.index') }}" class="btn btn-outline-secondary btn-sm">
                    <i class="fas fa-arrow-left me-2"></i> Zpět na žádosti
                </a>
                {% else %}
                    <a href="{{ url_for('chamber_applications.detail', application_id=application.id) }}" class="btn btn-outline-secondary btn-sm">
                    <i class="fas fa-arrow-left me-2"></i> Zpět na detail žádosti
                </a>
                {% endif %}
            </div>
            <div class="container-xl pb-4">
                <div class="d-flex justify-content-between align-items-center flex-wrap gap-3">

                    <h1 class="text-secondary">{{ form.title }}</h1>


                </div>
            </div>

            <!-- Include the filters component-->
            <!-- Table Wrapper -->
            <div class="card shadow-sm mb-4">
                <form method="POST" class="p-4">
                    {{ form.hidden_tag() }}

                    <!-- Student applicant -->
                    <div class="mb-3">
                        {{ form.student.label(class="form-label") }}
                        {{ form.student(class="form-select") }}
                        {% if form.student.errors %}
                            <div class="text-danger">
                                {{ form.student.errors[0] }}
                            </div>
                        {% endif %}
                    </div>

                    <!-- Notes -->
                    <div class="mb-3">
                        {{ form.notes.label(class="form-label") }}
                        {{ form.notes }}
                        {% if form.notes.errors %}
                            <div class="text-danger">
                                {{ form.notes.errors[0] }}
                            </div>
                        {% endif %}
                    </div>


                    <!-- Multiple players -->
                    <div class="mb-3">
                        {{ form.players.label(class="form-label") }}
                        {{ form.players(class="form-select", multiple=True, size=8) }}
                        {% if form.players.errors %}
                            <div class="text-danger">
                                {{ form.players.errors[0] }}
                            </div>
                        {% endif %}
                    </div>

                    <!-- Submission date -->
                    <div class="mb-3">
                        {{ form.submission_date.label(class="form-label") }}
                        {{ form.submission_date(class="form-control", type="date") }}
                        {% if form.submission_date.errors %}
                            <div class="text-danger">
                                {{ form.submission_date.errors[0] }}
                            </div>
                        {% endif %}
                    </div>

                    <!-- Submit button -->
                    <div class="mt-3">
                        {{ form.submit(class="btn btn-primary") }}
                    </div>
                </form>
            </div>

        </div>
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                new TomSelect('select[name="players"]', {
                    plugins: ['remove_button'],
                    placeholder: 'Select players...',
                    create: false,
                });
                new TomSelect('select[name="student"]', {
                    plugins: ['remove_button'],
                    placeholder: 'Vyberte studenta...',
                    multiple: false,
                    create: false,
                });
            });
        </script>
    </main>
{% endblock %}
