{% from "macros/_filters.jinja" import select_filter, text_filter, button_row with context %}

<div class="card-header bg-white">
    <form method="get" class="p-3 mb-4">
        <div class="row g-3 align-items-end">

            {{ select_filter('Nástroj', 'instrument_id', 'instrument_id',
                       instruments, selected_instrument_ids, placeholder='Vyberte nástroj(e)') }}

            {{ select_filter('Pedagog', 'teacher_id', 'teacher_id',
                       teachers, selected_teacher_ids, placeholder='Vyberte pedagoga') }}

            {{ select_filter('Katedra pedagoga', 'department_id', 'department_id',
                       departments, selected_department_ids, placeholder='Vyberte katedru') }}

            {# Incomplete ensembles #}
            <div class="col-md-3">
                <label for="incomplete" class="form-label">Kompletnost</label>
                <select class="form-select form-select-sm" id="incomplete" name="incomplete" multiple>
                    <option value="1" {% if request.args.get('incomplete') == '1' %}selected{% endif %}>Neúplné</option>
                    <option value="0" {% if request.args.get('incomplete') == '0' %}selected{% endif %}>Kompletní
                    </option>
                </select>
            </div>

            {# Health check filter #}
            <div class="col-md-3">
                <label for="health" class="form-label">Stav souboru</label>
                <select class="form-select form-select-sm" id="health" name="health">
                    <option value="">Všechny</option>
                    <option value="OK" {{ 'selected' if health_filter == 'OK' else '' }}>OK</option>
                    <option value="Soubor nesplňuje kritérium minima hráčů."
                            {{ 'selected' if health_filter == 'Soubor nesplňuje kritérium minima hráčů.' else '' }}>
                        Nesplňuje minimum hráčů
                    </option>
                    <option value="Soubor obsahuej vysoké procento hostů."
                            {{ 'selected' if health_filter == 'Soubor obsahuej vysoké procento hostů.' else '' }}>
                        Vysoké procento hostů
                    </option>
                </select>
            </div>

            {{ text_filter('Hledat hráče nebo soubor', 'filter-q', 'q',
                     search_query, placeholder='Jméno hráče nebo název souboru...') }}

            {{ button_row(show_reset=request.args, reset_url=url_for('ensemble.index')) }}

        </div>
    </form>

    {% include "partials/_tomselect_init.html" %}
</div>
