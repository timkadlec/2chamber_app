<div class="card mb-3">
    <div class="card-body py-2">
        <form method="get" class="row g-2 align-items-center">
            <!-- Instrument filter -->
            <div class="col-sm-4 col-md-3">
                <select class="form-select form-select-sm" id="instrument_id" name="instrument_id" multiple>
                    {% for inst in instruments %}
                        <option value="{{ inst.id }}"
                                {% if inst.id in (selected_instrument_ids or []) %}selected{% endif %}>
                            {{ inst.name }}
                        </option>
                    {% endfor %}
                </select>
            </div>

            <!-- Subject filter -->
            <div class="col-sm-4 col-md-3">
                <select class="form-select form-select-sm" id="subject_id" name="subject_id" multiple>
                    {% for subj in subjects %}
                        <option value="{{ subj.id }}"
                                {% if subj.id in (selected_subject_ids or []) %}selected{% endif %}>
                            {{ subj.name }}
                        </option>
                    {% endfor %}
                </select>
            </div>

            <!-- Has Ensemble filter -->
            <div class="col-sm-4 col-md-3">
                <select class="form-select form-select-sm" id="has_ensemble" name="has_ensemble">
                    <option value="">-- Má / nemá soubor --</option>
                    <option value="1" {% if selected_has_ensemble == '1' %}selected{% endif %}>Má soubor</option>
                    <option value="0" {% if selected_has_ensemble == '0' %}selected{% endif %}>Nemá soubor</option>
                </select>
            </div>


            <!-- Search field -->
            <div class="col-sm-6 col-md-3">
                <input type="text" class="form-control form-control-sm"
                       name="q"
                       value="{{ search_query or '' }}"
                       placeholder="Hledat jméno studenta...">
            </div>

            <!-- Submit + Reset -->
            <div class="col-auto">
                <button type="submit" class="btn btn-sm btn-primary">Filtrovat</button>
                <a href="{{ url_for('students.index') }}" class="btn btn-sm btn-outline-secondary">Reset</a>
            </div>
        </form>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        new TomSelect("#instrument_id", {
            plugins: ['remove_button'],
            placeholder: "Vyberte nástroj(e)",
        });
        new TomSelect("#subject_id", {
            plugins: ['remove_button'],
            placeholder: "Vyberte předmět(y)",
        });
        new TomSelect("#has_ensemble", {
            plugins: ['remove_button'],
            placeholder: "Má / nemá soubor",
            maxItems: 1
        });
    });
</script>
